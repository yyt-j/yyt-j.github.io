<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>MySQL笔记 | Yyt Blog</title><meta name="author" content="久绊"><meta name="copyright" content="久绊"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="mysql学习笔记"><meta property="og:type" content="article"><meta property="og:title" content="MySQL笔记"><meta property="og:url" content="https://yyt.gs/mysql/index.html"><meta property="og:site_name" content="Yyt Blog"><meta property="og:description" content="mysql学习笔记"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/head.jpg"><meta property="article:published_time" content="2023-02-21T10:01:00.000Z"><meta property="article:modified_time" content="2023-04-19T01:10:00.000Z"><meta property="article:author" content="久绊"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/head.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yyt.gs/mysql/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://npm.elemecdn.com/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?a53e51c9196a40c5aaff2f09d6e02097";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 久绊",link:"链接: ",source:"来源: Yyt Blog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1}}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"MySQL笔记",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-04-19 09:10:00"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.getCSS=e=>new Promise(((t,o)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=()=>t(),n.onerror=()=>o(),document.head.appendChild(n)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const n=saveToLocal.get("aside-status");void 0!==n&&("hide"===n?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/global.css"><link rel="stylesheet" href="https://at.alicdn.com/t/c/font_3983041_7tjj8jivcxr.css"><link rel="stylesheet" href="/cdn/css/cardlistpost.min.css"><style>#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags:before{content:"\A";white-space:pre}#recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags>.article-meta__separator{display:none}</style><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://q2.qlogo.cn/g?b=qq&amp;nk=2913319095&amp;s=100" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-zhuye1"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-xiangmuguidang"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-fenlei1"></i> <span>分类</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-quanbu"></i> <span>全部分类</span></a></li><li><a class="site-page child" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><i class="fa-fw iconfont icon-biji"></i> <span>学习笔记</span></a></li><li><a class="site-page child" href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/"><i class="fa-fw iconfont icon-sheji"></i> <span>课程设计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-chaolianjie"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-guanyuwomen"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-fenleiguanli"></i> <span>线路</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://yyt.gs"><i class="fa-fw iconfont icon-zhuye"></i> <span>主节点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.yyt.gs"><i class="fa-fw iconfont icon-netlify"></i> <span>Netlify线路</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://yyt-j.github.io"><i class="fa-fw iconfont icon-github"></i> <span>GitHub线路</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Yyt Blog"><span class="site-name">Yyt Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-zhuye1"></i> <span>主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-xiangmuguidang"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-fenlei1"></i> <span>分类</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-quanbu"></i> <span>全部分类</span></a></li><li><a class="site-page child" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><i class="fa-fw iconfont icon-biji"></i> <span>学习笔记</span></a></li><li><a class="site-page child" href="/categories/%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/"><i class="fa-fw iconfont icon-sheji"></i> <span>课程设计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-chaolianjie"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-guanyuwomen"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-fenleiguanli"></i> <span>线路</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://yyt.gs"><i class="fa-fw iconfont icon-zhuye"></i> <span>主节点</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.yyt.gs"><i class="fa-fw iconfont icon-netlify"></i> <span>Netlify线路</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://yyt-j.github.io"><i class="fa-fw iconfont icon-github"></i> <span>GitHub线路</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">MySQL笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-21T10:01:00.000Z" title="发表于 2023-02-21 18:01:00">2023-02-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-19T01:10:00.000Z" title="更新于 2023-04-19 09:10:00">2023-04-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>44分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="MySQL笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="MySQL笔记"><a href="#MySQL笔记" class="headerlink" title="MySQL笔记"></a>MySQL笔记</h1><h1 id="SQL命令的使用规则"><a href="#SQL命令的使用规则" class="headerlink" title="SQL命令的使用规则"></a>SQL命令的使用规则</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- SQL命令不区分字母大小写（密码、变量值除外）</span><br><span class="line">- 每条SQL·命令以；结束</span><br><span class="line">- 默认命令不支持Tab键自动补齐</span><br><span class="line">- \c 终止SQL命令</span><br></pre></td></tr></table></figure><p>管理数据库使用SQL（结构化查询语言）</p><ul><li><strong>DDL</strong> 数据定义语言 如：create、alter、drop</li><li><strong>DML</strong> 数据操作语言 如：insert update delete</li><li><strong>DCL</strong> 数据控制语言 如：grant、revoke</li><li>**DTL **数据事物语言 如：commit、rollback、savepoint</li></ul><h1 id="连接方式"><a href="#连接方式" class="headerlink" title="连接方式"></a>连接方式</h1><ol><li><p><strong>命令行</strong><br>使用mysql命令连接<br><code>- mysql -u用户名 -p密码 [数据库名]</code><br><code>- quit或exit退出</code></p></li><li><p>web页面</p><p><code>- phpmyadmin</code></p></li><li><p>安装图形页面软件</p><p><code>- SQL yang</code></p></li><li><p>编写脚本（java python，php）</p></li></ol><h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><div align="center"><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20230406160551816.png" alt="image-20230406160551816" style="zoom:50%"></div><h2 id="字符类型"><a href="#字符类型" class="headerlink" title="字符类型"></a>字符类型</h2><p><code>char</code></p><p>定长：char(字符个数)</p><ul><li>最大字符个数255</li><li>不够指定字符个数时在右边用空格补全</li><li>字符个数超出时，无法写入数据</li></ul><p><code>varchar</code></p><p>变长：varchar(字符个数)，最多可以存65532个字符</p><ul><li>根据数据实际大小分配存储空间</li><li>字符个数超出时无法写入数据</li></ul><p><code>text/blob</code></p><p>大文本类型</p><ul><li>字符数大于65535存储时使用</li></ul><h2 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h2><p>整数类型</p><div align="center"><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20230406201909853.png" alt="image-20230406201909853" style="zoom:50%"></div><p>浮点型</p><div align="center"><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20230406202218809.png"></div><h2 id="日期时间类型"><a href="#日期时间类型" class="headerlink" title="日期时间类型"></a>日期时间类型</h2><p><strong>日期：</strong><code>date</code></p><p>范围: 0001-01-01~9999-12-31</p><p>格式: yyyymmdd(如：19491001)</p><p><strong>年：</strong><code>year</code></p><p>范围：901~2155</p><p>格式：yyyy(如：1998)</p><p><strong>时间：</strong><code>time</code></p><p>格式：HHMMSS(如:221828)</p><p><strong>日期时间</strong>：<code>datetime</code>（存储范围大）</p><p>范围:1000-01-01 00:00:00~9999-12-31 23:59:59</p><p>格式：yyyymmddhhmmss</p><p><strong>日期时间：</strong><code>timestamp</code></p><p>范围：1970-01-01 00:00:00~2038-01-19 00:00:00</p><p>格式：yyyymmddhhmmss</p><h2 id="类型关键字注意"><a href="#类型关键字注意" class="headerlink" title="类型关键字注意"></a>类型关键字注意</h2><ul><li><p>关于日期时间字段</p><ul><li>当未给timestamp字段赋值时，自动以当前系统时间赋值，而datetime值为NULL（空）</li></ul></li><li><p>year类型</p><ul><li>要求使用4位数赋值</li><li>当使用2位数赋值时:01~99</li><li>01-69视为 2001~2069</li><li>70<del>99视为 1970</del>1999</li></ul></li></ul><h2 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h2><p>字段的值必须在指定的范围内选择。</p><p><code>enum</code> 单选</p><ul><li>格式：字段名 enum(值1，值2,值N)</li><li>仅能在列表里选择一个值</li></ul><p><code>set</code>多选</p><ul><li>格式：字段名 set(值1，值2，值N)</li><li>在列表里选择一个或多个值</li></ul><h1 id="数据库基本管理"><a href="#数据库基本管理" class="headerlink" title="数据库基本管理"></a>数据库基本管理</h1><p><strong>相关杂命令</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">记录类似文件中的行</span><br><span class="line">- select * from 库名.表名;				   #查看表记录</span><br><span class="line">- insert into 库名.表名 values(值列表)		#插入表记录</span><br><span class="line"># 此命令插入对应的是表里面有多少列都需要有多少值</span><br><span class="line"># 如何指定字段添加插入多条数据</span><br><span class="line">- insert into 表名(id,name.dizhi) values(id,name,dizhi),(id,name,dizhi);</span><br><span class="line"># 指定插入对应字段，并批量插入多行数据</span><br><span class="line">- delete from 表名 where id=102;</span><br><span class="line"># 删除指定ID为102的行</span><br><span class="line">- delete from 表名 where id=102 and name=&#x27;ccc&#x27;;</span><br><span class="line"># 删除指定ID为102并且name为ccc的行，如果有一个不符合将不会执行删除</span><br><span class="line">- delete from 表名 where id =102 or name=&#x27;ccc&#x27;;</span><br><span class="line"># 删除过户指定ID为102或者是name等于ccc的行数据只要满足一个就会被删除</span><br><span class="line">- delete from 表名;</span><br><span class="line"># 删除所有数据</span><br><span class="line">- update t1 set name=&#x27;ccc&#x27;;</span><br><span class="line"># 更新表数据</span><br><span class="line"># 将t1表里面所有name的字段改为ccc</span><br><span class="line">- update t1 set name=&#x27;ccc&#x27;,dizhi=&#x27;beijing&#x27;  where id=102;</span><br><span class="line"># 指定id为102的行把name改为ccc dizhi改为beijing</span><br><span class="line">- truncate table 表名;					#清空表数据</span><br><span class="line">- drop table 表名;						#删除表</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="DDL-库管理操作"><a href="#DDL-库管理操作" class="headerlink" title="DDL-库管理操作"></a>DDL-库管理操作</h2><blockquote><p>DDL语言用于对数据库和表结构的字段</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select use();                             #显示连接的用户  </span><br><span class="line">use   库名;							     #切换库</span><br><span class="line">select database();                         #获取当前所在的库</span><br><span class="line">show databases;                            #查看所有数据库</span><br><span class="line">create database if not exists 库名;        #建新库，如果已存在不会报错</span><br><span class="line">show tables;                              #显示已有的表</span><br><span class="line">drop database if exists 库名;             #删除库，如果不存在不会报错</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="DDL-表结构修改"><a href="#DDL-表结构修改" class="headerlink" title="DDL-表结构修改"></a>DDL-表结构修改</h2><p>添加一个字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add 字段名 类型(长度)[comment 注释][约束]; #关键字段add表示添加的意思</span><br></pre></td></tr></table></figure><p>在创建时如果需要调整顺序可以使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add 字段名 列名 first; # 添加到表第一列</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add 字段 列名 after 列名2; # 添加到列名2的后面</span><br></pre></td></tr></table></figure><p><code>first 第一</code></p><p><code>after 在......之后</code></p><p>修改列顺序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表明 modify column 列名1 数据类型 first|after 列名2;</span><br></pre></td></tr></table></figure><p><strong>格式说明：</strong> <em>列名1为所要调整顺序的列名，first表示将列调整到表的第一个位置，after列名2表示将列调整到列名2之后。</em></p><p>修改数据类型</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify 字段名 新数据类型（长度）; #关键词modify</span><br></pre></td></tr></table></figure><p>修改字段名和字段类型</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 change 旧字段名 新字段名 类型 长度 #关键词change</span><br></pre></td></tr></table></figure><p>删除字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop 字段名; #关键词drop</span><br></pre></td></tr></table></figure><p>修改表名字</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 rename to 新表名; #关键词 rename to</span><br></pre></td></tr></table></figure><p>删除表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table 表名; </span><br></pre></td></tr></table></figure><p>删除表,并重新创建该表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truncate table 表名; </span><br></pre></td></tr></table></figure><h2 id="DML-添加表数据"><a href="#DML-添加表数据" class="headerlink" title="DML-添加表数据"></a>DML-添加表数据</h2><blockquote><p>数据操作语言，用来对数据库中表的数据记录进行增删改操作</p></blockquote><ul><li>给指定字段添加数据</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名(值1,值2,......) values(值1,值2,......); #点表示后面还有</span><br></pre></td></tr></table></figure><ul><li>给全部字段添加数据</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名 values(值1,值2,......); #注意值需要与表中字段一一对应</span><br></pre></td></tr></table></figure><ul><li>批量添加数据</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名(字段1,字段2,......) values(值1,值2,.....),(值1,值2,.....),(值1,值2,.....);</span><br><span class="line">insert into 表名 values(值1,值2,.....),(值1,值2,.....),(值1,值2,.....);</span><br></pre></td></tr></table></figure><p><font color="red">注意</font></p><ul><li>插入数据时，指定的字段顺序需要与值的顺序是一一对应的</li><li>字符串和日期类型数据应该包含到引号中</li><li>插入数据的大小，应该是在字段的规定范围内</li></ul><h2 id="DML-修改表数据"><a href="#DML-修改表数据" class="headerlink" title="DML-修改表数据"></a>DML-修改表数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update 表名 set 字段名1=值1,字段名2=值2,......[where条件] #关键字update和set</span><br></pre></td></tr></table></figure><p><font color="red">注意</font></p><ul><li>修改语句的条件可以有，也可以没有，如果没有则会修改整张表的所有数据。</li><li>如需修改多个字段可以用逗号隔开</li></ul><h2 id="DML-删除表数据"><a href="#DML-删除表数据" class="headerlink" title="DML-删除表数据"></a>DML-删除表数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名 [where 条件] #关键字delete和from</span><br></pre></td></tr></table></figure><p><font color="red"> 注意</font></p><ul><li>delete语句的条件可以有，也可以没有，如果没有条件，则会删除整张表的所有数据。</li><li>delete语句不能删除某一个字段的值(可以使用update)</li></ul><h2 id="DQL-常用查询"><a href="#DQL-常用查询" class="headerlink" title="DQL-常用查询"></a>DQL-常用查询</h2><blockquote><p>数据查询语言，用来查询数据库中的表的记录 查询关键字：select</p><blockquote><p>字段可以使用数学表达式</p></blockquote></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">	字段列表</span><br><span class="line">from</span><br><span class="line">	表名列表</span><br><span class="line">where</span><br><span class="line">	条件列表</span><br><span class="line">group by </span><br><span class="line">	分组字段列表</span><br><span class="line">having</span><br><span class="line">	分组后条件列表</span><br><span class="line">order by</span><br><span class="line">	排序字段列表</span><br><span class="line">limit</span><br><span class="line">	分页参数</span><br></pre></td></tr></table></figure><p>1.查询指定字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段1,字段2 from 表名; #查询指定字段</span><br></pre></td></tr></table></figure><p>1.1.查询全部字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 表名;</span><br></pre></td></tr></table></figure><p>2.设置别名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段1 as 别名1 from 表名; #取别名时as可以省略 别名是中文用单引号阔起来</span><br></pre></td></tr></table></figure><p>演示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select name &#x27;名字&#x27; from  t2; # 查询name字段设置别名:名字</span><br><span class="line">+--------+</span><br><span class="line">| 名字   |</span><br><span class="line">+--------+</span><br><span class="line">| yyt    |</span><br><span class="line">| hlk    |</span><br><span class="line">+--------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.<strong>去除重复记录</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select distinct 字段列表 from 表名;</span><br></pre></td></tr></table></figure><h2 id="DQL-条件查询"><a href="#DQL-条件查询" class="headerlink" title="DQL-条件查询"></a>DQL-条件查询</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 where 条件列表;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center"><font color="red">比较运算符</font></th><th align="center"><font color="red">功能</font></th></tr></thead><tbody><tr><td align="center">&gt;</td><td align="center">大于</td></tr><tr><td align="center">&gt;=</td><td align="center">大于等于</td></tr><tr><td align="center">&gt;</td><td align="center">小于</td></tr><tr><td align="center">&lt;=</td><td align="center">小于等于</td></tr><tr><td align="center">=</td><td align="center">等于</td></tr><tr><td align="center">&lt;&gt;或!=</td><td align="center">不等于</td></tr><tr><td align="center">between…and…</td><td align="center">在某个范围内含(最小,最大值)</td></tr><tr><td align="center">in(……)</td><td align="center">在in后面的列表里的值多选一</td></tr><tr><td align="center">like 占位符</td><td align="center">模糊匹配（_匹配单个字符,%匹配任意个字符）</td></tr><tr><td align="center">is null</td><td align="center">是null</td></tr><tr><td align="center">is not null</td><td align="center">不是null</td></tr></tbody></table><table><thead><tr><th align="center"><font color="red">逻辑运算符</font></th><th align="center"><font color="red">功能</font></th></tr></thead><tbody><tr><td align="center">and或&amp;&amp;</td><td align="center">并且（多个条件同时成立）</td></tr><tr><td align="center">or或||</td><td align="center">或者（多个条件任意一个成立）</td></tr><tr><td align="center">not或！</td><td align="center">非，不是</td></tr></tbody></table><p><strong>查询age（年龄）大于等于19的数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select *from t2 where age&gt;=19; # 注意这里的&gt;=其实是分开的两个字符，因为本笔记软件的显示异常</span><br><span class="line">+------+------+------------+</span><br><span class="line">| name | age  | sfz        |</span><br><span class="line">+------+------+------------+</span><br><span class="line">| hlk  |   19 | 1234567890 |</span><br><span class="line">| wgh  |   19 |        123 |</span><br><span class="line">| dzy  |   19 |      12345 |</span><br><span class="line">| xxx  |   20 |     123456 |</span><br><span class="line">+------+------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>查询age年龄不等于18并且sfz等于123的数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select *from t2 where age!=18 &amp;&amp; sfz=123; # 这里&amp;&amp;表示的等同于and</span><br><span class="line">+------+------+------+</span><br><span class="line">| name | age  | sfz  |</span><br><span class="line">+------+------+------+</span><br><span class="line">| wgh  |   19 |  123 |</span><br><span class="line">+------+------+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>查询年龄等于19或者是年龄等于20</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select *from t2 where age=19 or age=20;	#这里查出的年龄等于19或者是年龄等于20的所有人</span><br><span class="line">+------+------+------------+</span><br><span class="line">| name | age  | sfz        |</span><br><span class="line">+------+------+------------+</span><br><span class="line">| hlk  |   19 | 1234567890 |</span><br><span class="line">| wgh  |   19 |        123 |</span><br><span class="line">| dzy  |   19 |      12345 |</span><br><span class="line">| xxx  |   20 |     123456 |</span><br><span class="line">+------+------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>查询年龄小于19的数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select age &#x27;年龄&#x27; from t2  where age&lt;19; #取了个别名，年龄小于19的只有一位</span><br><span class="line">+--------+</span><br><span class="line">| 年龄   |</span><br><span class="line">+--------+</span><br><span class="line">|     18 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>查询年龄最小在15岁，最大在20岁之间的数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 表名 where age between 15 and 20；</span><br></pre></td></tr></table></figure><p><strong>查询年龄等于15或者20或者30的信息</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 表名 where age = 15 or age = 20 or age = 30；</span><br></pre></td></tr></table></figure><p><strong>为了避免以上的多个or可以使用in(….)</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 表名 where age in(15,20,30);</span><br></pre></td></tr></table></figure><p><strong>查询名字为两个字的信息</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 表名 where name like &#x27;__&#x27;;</span><br></pre></td></tr></table></figure><p><strong>查询身份证号最后一位为X的员工信息</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 表名 where sfz like &#x27;%X&#x27;</span><br></pre></td></tr></table></figure><h2 id="DQL-聚合函数查询"><a href="#DQL-聚合函数查询" class="headerlink" title="DQL-聚合函数查询"></a>DQL-聚合函数查询</h2><blockquote><p>将一列数据作为一个整体进行纵向计算。</p></blockquote><p><strong>常见的聚合函数</strong></p><table><thead><tr><th align="center">函数</th><th align="center">功能</th></tr></thead><tbody><tr><td align="center">count</td><td align="center">统计数量</td></tr><tr><td align="center">max</td><td align="center">最大值</td></tr><tr><td align="center">min</td><td align="center">最小值</td></tr><tr><td align="center">avg</td><td align="center">平均值</td></tr><tr><td align="center">sum</td><td align="center">求和</td></tr></tbody></table><p><strong>语法</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 聚合函数(字段列表) from 表名;</span><br></pre></td></tr></table></figure><p>统计表全部数量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from 表名 #统计所有</span><br></pre></td></tr></table></figure><p><font color="red">注意：</font><font color="orac">所有的null值不参与所有聚合函数的运算。</font></p><p>演示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select count(*) from t2; #这里用统计函数count而不是用sum</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|        5 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>求年龄的平均值</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select *from t2; # 查看一下表的所有内容</span><br><span class="line">+------+------+------------+</span><br><span class="line">| name | age  | sfz        |</span><br><span class="line">+------+------+------------+</span><br><span class="line">| yyt  |   18 |        291 |</span><br><span class="line">| hlk  |   19 | 1234567890 |</span><br><span class="line">| wgh  |   19 |        123 |</span><br><span class="line">| dzy  |   19 |      12345 |</span><br><span class="line">| xxx  |   20 |     123456 |</span><br><span class="line">+------+------+------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select avg(age) from t2;		#统计年龄字段的平均值，这里用了avg函数</span><br><span class="line">+----------+</span><br><span class="line">| avg(age) |</span><br><span class="line">+----------+</span><br><span class="line">|  19.0000 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>求所有人年龄当中的最大值</strong>；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select max(age) &#x27;年龄&#x27; from t2; #可以对聚合函数上使用别名，使用求最大值的函数max</span><br><span class="line">+--------+</span><br><span class="line">| 年龄   |</span><br><span class="line">+--------+</span><br><span class="line">|     20 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>求所有人年龄最小的那一个带名字</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select min(age) &#x27;年龄&#x27; from t2; #求最小值的函数是min</span><br><span class="line">+--------+</span><br><span class="line">| 年龄   |</span><br><span class="line">+--------+</span><br><span class="line">|     18 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="DQL-分组查询"><a href="#DQL-分组查询" class="headerlink" title="DQL-分组查询"></a>DQL-分组查询</h2><p>语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 [where 条件] group by 分组字段名 [having 分组过滤后的条件]</span><br></pre></td></tr></table></figure><blockquote><p>where不能对聚合函数进行判断，<font color="red">having</font>支持使用聚合函数</p><p>执行时机不同where是对分组之前进行过滤，having是对分组之后进行过滤</p><blockquote><p><code>group by</code> 关键词</p></blockquote></blockquote><p>注意事项</p><ul><li>执行顺序：where&gt;聚合函数&gt;having</li><li>分组之后查询的字段一般为聚合函数和分组字段，查询其他字段毫无意义</li></ul><p><strong>根据学生信息表bstudent查找出有几个女生几个男生</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select stud_sex &#x27;性别&#x27;,count(*) from studentscore.bstudent group by stud_sex;</span><br><span class="line">+--------+----------+</span><br><span class="line">| 性别   | count(*) |</span><br><span class="line">+--------+----------+</span><br><span class="line">| 女     |        7 |</span><br><span class="line">| 男     |       10 |</span><br><span class="line">+--------+----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="DQL-排序查询"><a href="#DQL-排序查询" class="headerlink" title="DQL-排序查询"></a>DQL-排序查询</h2><p>语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 order by 字段1 排序方式1，字段2 排序方式2;</span><br></pre></td></tr></table></figure><p>排序方式</p><ul><li>asc代表升序</li><li>desc代表降序</li></ul><p><strong><font color="red">注意：如果是多字段进行排序，当第一个字段值相同时，才会根据第二个字段进行排序 <br>  默认按照asc升序进行排序所以asc默认可以不写</font></strong></p><h2 id="DQL-分页查询"><a href="#DQL-分页查询" class="headerlink" title="DQL-分页查询"></a>DQL-分页查询</h2><p>语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 limit 起始索引，查询记录数</span><br></pre></td></tr></table></figure><p>注意</p><ul><li><font color="red">起始索引从0开始，起始索引=（查询页码-1）*每页显示记录数。</font></li><li>分页查询是数据库方言，不同的数据库有不同的实现，mysql中是limit</li><li>如果查询的是第一页数据，起始索引可以省略，直接简写为limit10。</li></ul><h2 id="DCL-数据控制语言"><a href="#DCL-数据控制语言" class="headerlink" title="DCL-数据控制语言"></a>DCL-数据控制语言</h2><blockquote><p>DCL数据控制语言，用来管理数据库，用户，控制数据库的访问，权限。</p></blockquote><h2 id="DCL-管理用户"><a href="#DCL-管理用户" class="headerlink" title="DCL-管理用户"></a>DCL-管理用户</h2><p>查询用户</p><ul><li>mysql数据库中用户的信息都是存放在“mysql”数据库中user表中</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">select *from mysql.user;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 示例</span><br><span class="line">mysql&gt; select *from mysql.user;</span><br><span class="line">+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+</span><br><span class="line">| Host      | User          | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin                | authentication_string                     | password_expired | password_last_changed | password_lifetime | account_locked |</span><br><span class="line">+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+</span><br><span class="line">| localhost | root          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *E148ACD30EACBC5E1BC84CD068AEB31EB6C8C749 | N                | 2022-09-17 00:18:35   |              NULL | N              |</span><br><span class="line">| localhost | mysql.session | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | Y          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2022-09-17 00:12:27   |              NULL | Y              |</span><br><span class="line">| localhost | mysql.sys     | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2022-09-17 00:12:27   |              NULL | Y              |</span><br><span class="line">+-----------+---------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+</span><br><span class="line">3 rows in set (0.10 sec)</span><br></pre></td></tr></table></figure><p>创建用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create user &#x27;用户名&#x27;@&#x27;主机名&#x27; identified by &#x27;密码&#x27;;</span><br><span class="line">创建用户yyt</span><br><span class="line">create user &#x27;yyt&#x27;@&#x27;localhost&#x27; identified by &#x27;123456&#x27;;</span><br><span class="line"># 需要可以在任意主机上访问</span><br><span class="line">把localhost改为%号</span><br></pre></td></tr></table></figure><ul><li>创建一个用户yyt，只能够在localhost访问，密码是123456</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create user &#x27;yyt&#x27;@&#x27;localhost&#x27; identified by &#x27;123456&#x27;；</span><br><span class="line"></span><br><span class="line"># 示例</span><br><span class="line">mysql&gt; create user &#x27;yyt&#x27;@&#x27;localhost&#x27; identified by &#x27;123456&#x27;</span><br><span class="line">    -&gt; ;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure><ul><li>创建一个用户dzy，可以在任何一台机器上访问我们的mysql数据库</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">create user &#x27;dzy&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27; # %表示通配，可以在任意主机上面访问</span><br><span class="line"></span><br><span class="line"># 示例</span><br><span class="line">mysql&gt; select count(*) from mysql.user; #	首先通过我我们前面学的聚合函数count求数据库总用户数量</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|        3 |					# 得到的结果是三个用户，此结果是在创建yyt用户前面执行的，所以创建dzy就会显示五个用户</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create user &#x27;dzy&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27;; #创建一个可以在任何机器上访问的用户</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select count(*) from mysql.user; # 我们可以看到目前的结果的确是五个用户</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|        5 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong>修改用户可以在任意主机上访问</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update mysql.user set Host=&#x27;%&#x27; where User=&#x27;用户名&#x27;;</span><br></pre></td></tr></table></figure><p><strong>修改用户密码</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter user &#x27;用户名&#x27;@&#x27;主机名&#x27; identified with mysql_native_password by &#x27;1234&#x27;;</span><br></pre></td></tr></table></figure><ul><li>修改用户dzy的用户为000000</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">alter user &#x27;dzy&#x27;@&#x27;%&#x27; identified with mysql_native_password by &#x27;000000&#x27;</span><br><span class="line"></span><br><span class="line"># 示例</span><br><span class="line">mysql&gt; alter user &#x27;dzy&#x27;@&#x27;%&#x27; identified with mysql_native_password by &#x27;000000&#x27;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"># 另一个方法，在mysql命令行外面执行</span><br><span class="line">mysqladmin -uroot -p旧密码 password 新密码;</span><br></pre></td></tr></table></figure><p><strong>设置当前用户密码</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set password = password(&#x27;密码&#x27;);</span><br></pre></td></tr></table></figure><p><strong>修改指定用户密码</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set password for 用户名 = password(&#x27;密码&#x27;);</span><br></pre></td></tr></table></figure><p><strong>给用户重命名</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename user 原用户名 to 新用户名;</span><br></pre></td></tr></table></figure><p><strong>删除用户</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop user &#x27;用户名&#x27;@&#x27;主机名&#x27;；</span><br></pre></td></tr></table></figure><p>注意</p><ul><li>主机名可以使用百分号通配</li><li>这类SQL开放人员操作的较少，主要是<font color="red">DBA数据库管理员</font>使用</li></ul><h2 id="DCL-权限控制"><a href="#DCL-权限控制" class="headerlink" title="DCL-权限控制"></a>DCL-权限控制</h2><blockquote><p>mysql中定义了很多权限</p><blockquote><p>以下是我们经常,常用的几种</p></blockquote></blockquote><table><thead><tr><th align="center">权限</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">alL,ALL PRIVILEGES</td><td align="center">所有权限</td></tr><tr><td align="center">select</td><td align="center">查询数据</td></tr><tr><td align="center">insert</td><td align="center">插入数据</td></tr><tr><td align="center">update</td><td align="center">修改数据</td></tr><tr><td align="center">delete</td><td align="center">删除数据</td></tr><tr><td align="center">alter</td><td align="center">修改表,修改字段</td></tr><tr><td align="center">drop</td><td align="center">删除数据库/表/视图</td></tr><tr><td align="center">create</td><td align="center">创建数据库/表</td></tr></tbody></table><ul><li>其他权限及描述的含义，需要去参考<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/">官方文档</a></li></ul><ol><li>查询权限</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">show grants for &#x27;用户名&#x27;@&#x27;主机名&#x27;；</span><br><span class="line"></span><br><span class="line"># 演示</span><br><span class="line">mysql&gt; show grants for &#x27;yyt&#x27;@&#x27;localhost&#x27;; #查询上面创建的用户yyt的权限</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| Grants for yyt@localhost                |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| GRANT USAGE ON *.* TO &#x27;yyt&#x27;@&#x27;localhost&#x27; |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure><ol start="2"><li>授予权限</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grant 权限列表 on 数据库名.表名 to &#x27;用户名&#x27;@&#x27;主机名&#x27;;</span><br><span class="line"></span><br><span class="line"># 如何给所有数据库表赋予权限？</span><br><span class="line"></span><br><span class="line">grant 权限列表 on *.* to &#x27;用户名&#x27;@&#x27;主机名&#x27;；</span><br><span class="line"></span><br><span class="line"># 如何给数据库所有表赋予权限</span><br><span class="line"></span><br><span class="line">grant 权限列表 on 指定库名.* to &#x27;用户名&#x27;@&#x27;主机名&#x27;；</span><br></pre></td></tr></table></figure><ol start="3"><li>撤销权限</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">revoke 权限 on 数据库名.表名 from &#x27;用户名&#x27;@&#x27;主机名&#x27;</span><br></pre></td></tr></table></figure><hr><h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><blockquote><p>函数是指一段可以直接被另一段程序调用的程序或代码</p></blockquote><p><a target="_blank" rel="noopener" href="https://imgse.com/i/xDGY0U"><img src="https://s1.ax1x.com/2022/10/17/xDGY0U.png" alt="xDGY0U.png" style="zoom:80%"></a></p><h2 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h2><p><a target="_blank" rel="noopener" href="https://imgse.com/i/xDGt7F"><img src="https://s1.ax1x.com/2022/10/17/xDGt7F.png" alt="xDGt7F.png"></a></p><p><strong>语法</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 函数(参数);</span><br></pre></td></tr></table></figure><ul><li>字符串拼接<ul><li>concat</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select concat(&#x27;hello&#x27;,&#x27;mysql&#x27;);			# 把hello和mysql这个字符串拼接</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2022/10/17/xDG2Ae.png" alt="演示图111111111111111111111111" style="zoom:80%">]</p><ul><li>填字符串str全部转为小写<ul><li>lower（str）</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select lower(&#x27;HELLO&#x27;); # 把括号内HELLO字符传全部转为小写</span><br></pre></td></tr></table></figure><ul><li>将所有的字符转为大写<ul><li>upper</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select upper(&#x27;hello&#x27;);</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://imgse.com/i/xDGOhj"><img src="https://s1.ax1x.com/2022/10/17/xDGOhj.png" alt="xDGOhj.png" style="zoom:80%"></a></p><ul><li>向左填充<ul><li>lpad</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select lpad(&#x27;01&#x27;,5,&#x27;-&#x27;);</span><br></pre></td></tr></table></figure><ul><li>向右填充<ul><li>rpad</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select rpad(&#x27;01&#x27;,5,&#x27;-&#x27;);</span><br></pre></td></tr></table></figure><ul><li>去除空格<ul><li>trim</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select trim(&#x27; hello mysql &#x27;); #trim 是去除左右两边的空格不去除中间的空格</span><br></pre></td></tr></table></figure><h2 id="时间函数"><a href="#时间函数" class="headerlink" title="时间函数"></a>时间函数</h2><blockquote><p>函数服务内置的命令，可以使用时间函数给字段赋值</p></blockquote><table><thead><tr><th><strong>类型</strong></th><th><strong>用途</strong></th></tr></thead><tbody><tr><td>curtime()</td><td>获取当前的系统时间</td></tr><tr><td>curdate()</td><td>获取当前的系统日期</td></tr><tr><td>now()</td><td>获取当前系统日期和时间</td></tr><tr><td>year()</td><td>获取年</td></tr><tr><td>month()</td><td>获取月</td></tr><tr><td>day()</td><td>获取日</td></tr><tr><td>date()</td><td>获取日期</td></tr><tr><td>time()</td><td>获取时间</td></tr></tbody></table><hr><h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><blockquote><ol><li>概念：约束是作用于表中字段上面的规则，用于限制存储在表中的数据</li><li>目的：保证数据库中数据的正确、有效性和完整性</li><li>分类</li></ol></blockquote><table><thead><tr><th align="center">约束</th><th align="center">描述</th><th align="center">关键字</th></tr></thead><tbody><tr><td align="center">非空约束</td><td align="center">限制字段的数值不能为null</td><td align="center">not null</td></tr><tr><td align="center">唯一约束</td><td align="center">保证该字段所有的数据都是唯一不重复的</td><td align="center">unique</td></tr><tr><td align="center">主键约束</td><td align="center">主键是一行数据的唯一标识要求非空且唯一</td><td align="center">primary by</td></tr><tr><td align="center">默认约束</td><td align="center">保存数据是如果未指定该字段的值，则采用默认值</td><td align="center">default</td></tr><tr><td align="center">检查约束（8.0.16版本之后）</td><td align="center">保证字段值满足某一个或多个条件</td><td align="center">check</td></tr><tr><td align="center">外键约束</td><td align="center">用来让两张表的数据之间建立链接，保证数据的一致性和完整性常见的约束型</td><td align="center">foreign key</td></tr></tbody></table><p><font color="red">注意：</font></p><p><em>检查约束至mysql 8.0.16版本后才支持</em></p><h2 id="约束演示"><a href="#约束演示" class="headerlink" title="约束演示"></a>约束演示</h2><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20221006102020701.png" alt="image-20221006102020701" style="zoom:80%"><p>对应的建表语句</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221006102502612.png" alt="image-20221006102502612"></p><h2 id="主键约束"><a href="#主键约束" class="headerlink" title="主键约束"></a>主键约束</h2><p><strong>通过修改表建立主键约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add constraint 自定义约束名 primary by （列名）;</span><br></pre></td></tr></table></figure><p><strong>删除主键约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop primary key;</span><br></pre></td></tr></table></figure><p>如果希望在向表中加入新行时能够由系统自动生成一个唯一标识红表中表中每行数据的序列值，则可以通过主键添加auto_increment关键字来实现</p><p><em>使用自增列时，需要注意如下三点，1 每张表只允许有一个自增列，2 该列的数据类型只能为整数类型，通常取int，3 该列不允许为null值，也不能有默认值，一般情况下不允许人为插入该列数值，也不允许修改该列的值</em></p><h2 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h2><p><strong>通过修改表建立外键约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add constraint 约束名 foreign key (列名) references 被参照表名 (被参照列名);</span><br></pre></td></tr></table></figure><p><strong>删除外键约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop foreign key 约束名;</span><br></pre></td></tr></table></figure><p><strong>实现级联更新，级联删除</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">on delete cascade # 级联删除</span><br><span class="line">on update cascade # 级联更新</span><br></pre></td></tr></table></figure><h2 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h2><p><strong>通过修改表建立唯一约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add constraint 约束名 unique (列名);</span><br></pre></td></tr></table></figure><p><strong>删除唯一约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop index 约束名</span><br></pre></td></tr></table></figure><h2 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束"></a>非空约束</h2><p><strong>通过修改表建立非空约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify 列名 数据类型 not null;</span><br></pre></td></tr></table></figure><p><strong>删除非空约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify 列名 数据类型 null;</span><br></pre></td></tr></table></figure><h2 id="检查约束"><a href="#检查约束" class="headerlink" title="检查约束"></a>检查约束</h2><p><strong>通过修改表建立检查约束</strong>、</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add constraint 约束名 check (条件表达式);</span><br></pre></td></tr></table></figure><p><strong>删除检查约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 drop check (条件表达式);</span><br></pre></td></tr></table></figure><h2 id="默认约束"><a href="#默认约束" class="headerlink" title="默认约束"></a>默认约束</h2><p><strong>通过修改表建立默认约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 alter 列名 set default 默认值;</span><br></pre></td></tr></table></figure><p><strong>删除唯一约束</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 alter 列名 drop default;</span><br></pre></td></tr></table></figure><h1 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h1><blockquote><p>一个关系型数据库中的多个表之间一般都存在着某种内在的联系（如外键约束），它们共同提供有用的信息，所以在实际的查询中，用户往往需要从多个表中查询相关数据。若一个查询同时涉及两个以上的表并通过连接条件实现，则称为连接查询。</p></blockquote><blockquote><p>笛卡尔积:笛卡尔乘积是指在数学中，两个集合，A集合和B集合的所有组合情况<font color="red">(在多表查询时需要消除无效的笛卡尔积)</font></p></blockquote><blockquote><p>笛卡尔积现象：当两张表进行连接查询的时候，没有任何条件限制，最终的查询结果条数是两张表记录条数的乘积</p></blockquote><blockquote><p>避免了笛卡尔积现象，但是并不会减少匹配次数，只不过显示的结果是有效记录</p></blockquote><h2 id="多表关系"><a href="#多表关系" class="headerlink" title="多表关系"></a>多表关系</h2><ul><li>概述<ul><li>项目开发中，在进行数据库结构设计时，会根据业务需求及业务模块之间的关系，分析设计表结构由于业务之间的相互关联，所以各个表结构之间也存在着各种联系，基本上分为三种：<ul><li>一对多(多对一)</li><li>多对多</li><li>一对一</li></ul></li></ul></li></ul><hr><ul><li>一对多（多对一）</li></ul><p><a target="_blank" rel="noopener" href="https://imgse.com/i/xrdKwq"><img src="https://s1.ax1x.com/2022/10/18/xrdKwq.png" alt="xrdKwq.png"></a></p><p><font color="green">部门是1的地方，员工是多的地方，因为一个部门可以有多个员工</font></p><hr><ul><li>多对多</li></ul><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221018150709113.png" alt="image-20221018150709113"></p><hr><ul><li>一对一</li></ul><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221018151100811.png" alt="image-20221018151100811"></p><p><font color="green">一对一经常用于拆分</font></p><hr><h2 id="多表查询概述"><a href="#多表查询概述" class="headerlink" title="多表查询概述"></a>多表查询概述</h2><blockquote><p>指从多张表中查询数据</p></blockquote><h2 id="连接查询-内连接"><a href="#连接查询-内连接" class="headerlink" title="连接查询-内连接"></a>连接查询-内连接</h2><blockquote><p>内连接查询的是两张表中字段交集的部分</p><blockquote><p>内连接的特点就是完全能匹配上这个条件的数据查询出来</p></blockquote></blockquote><p>隐式内连接:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表1，表2 where 条件...;</span><br></pre></td></tr></table></figure><ul><li>在进行多表查询的时候如果表名字比较长，我们在字段前面就需要加上比较长的表名，这个时候就需要给表设置别名，通过别名可以在表的后面空格加别名</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from emp e,emp2 d;</span><br></pre></td></tr></table></figure><p><strong>对于一个DQL语句来说先执行的是from，就可以给表起别名继续后面的操作</strong></p><p><font color="red">在显示内连接中inner这个关键字是可以省略的</font></p><p>显示内连接:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表1 [inner] join 表2 on 连接条件...;</span><br></pre></td></tr></table></figure><h2 id="外连接查询"><a href="#外连接查询" class="headerlink" title="外连接查询"></a>外连接查询</h2><blockquote><p>外连接和内连接的区别</p></blockquote><p><strong>左外连接语法：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表名 left [outer] join 表2 on 条件...;</span><br></pre></td></tr></table></figure><p>左外连接查询的是，完全包含左表，表1的数据也包含了表1和表2交集部分的数据</p><p><strong>右外连接语法：</strong></p><p>right代表：将join关键字右边的这张表看成主表，主要是为了将这张表的数据全部查询出来，捎带着关联查询左边的表。在外连接中两张表存在主次关系。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表1 right [outer] join 表2 on 条件；</span><br></pre></td></tr></table></figure><p>相当于查询表2（右表）的所有数据包含表1和表2交集部分的数据</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221023174225867.png" alt="右外连接"></p><p>查询bstudent表的所有数据及每个学生对应的班级</p><h2 id="自连接语法："><a href="#自连接语法：" class="headerlink" title="自连接语法："></a>自连接语法：</h2><blockquote><p>对一张表连续查询多次</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表A 别名A join 表A 别名 B on 条件表达式</span><br></pre></td></tr></table></figure><ul><li>在自连接查询中一定要给表起别名</li></ul><h2 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h2><blockquote><p>对于联合查询就是把多次查询的结果合并起来形成一个新的查询结果集</p><blockquote><p>关键字 union,union all</p><p>union all是直接将查询的结果合并</p><p>union 是将查询的结果进行去重</p></blockquote></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 字段列表 from 表A union [all] select 字段列表 from 表B;</span><br></pre></td></tr></table></figure><p>示例：查询学生表bstudent中性别是女 和 男生是团员的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from bstudent where stud_sex=&#x27;女&#x27; union select *from bstudent where stud_sex=&#x27;男&#x27; &amp;&amp; members=&#x27;团员&#x27;;</span><br></pre></td></tr></table></figure><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221024102426738.png" alt="image-20221024102426738"></p><p><font color="red">对于联合查询的多张表列数必须保持一致，字段类型也需要保持一致</font></p><p><font color="red">对于union all 会将全部的数据直接合并到一起，union会对合并之后的数据去重</font></p><h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><blockquote><p>在SQL语句中嵌套的select语句成为嵌套查询，又称<font color="red">子查询</font></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from t1 where column1=(select column1 from t2);</span><br></pre></td></tr></table></figure><ul><li>根据子查询结果不同，分为<ul><li>标量子查询（子查询结果为单个值）</li><li>列子查询（子查询结果为一列）</li><li>行子查询(子查询结果为一行）</li><li>表子查询（子查询的结果为多行多列）</li></ul></li></ul><ul><li>根据子查询位置，分为：where之后，from之后，select之后。</li></ul><p>where子句中的子查询可以看做是一个条件用括号包含</p><p>from子句中的子查询，可以将子查询的查询结果当做成一张临时表（看待</p><p>select后面出现的子查询，只能返回一条结果，多余一条就报错(这个内容不需要记住，了解即可)</p><h2 id="合并查询结果union"><a href="#合并查询结果union" class="headerlink" title="合并查询结果union"></a>合并查询结果union</h2><blockquote><p>合并查询结果集合</p></blockquote><p><strong>select查询语句之间用union进行合并</strong></p><p>使用union的效率要高一些，对于表连接来说，每连接一次新表则满足笛卡尔积，成倍的翻。。。。</p><p>但是union可以减少匹配的次数，在减少匹配次数的情况下还可以完成两个结果集的拼接。</p><p>union把乘法变成加法进行运算。union在使用时候注意，在进行结果集合并的时候要求两个结果集的列数相同，</p><h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><blockquote><p>事务是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败，事务一旦提交就不可逆。</p></blockquote><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221025095521164.png" alt="image-20221025095521164"></p><p><strong>查看事务提交方式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@autocommit;  # 查询结果显示1表示默认事物提交方式为自动提交</span><br></pre></td></tr></table></figure><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20221025150836290.png" alt="image-20221025150836290" style="zoom:50%"><p><strong>设置事务的提交方式-改为手动提交</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set @@autocommit=0; 			# 设置为0默认为手动提交</span><br></pre></td></tr></table></figure><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20221025151935102.png" alt="image-20221025151935102" style="zoom:50%"><p><strong>提交事务</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commit;</span><br></pre></td></tr></table></figure><p><strong>回滚事务</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollback;</span><br></pre></td></tr></table></figure><h2 id="事务的四大特性"><a href="#事务的四大特性" class="headerlink" title="事务的四大特性:"></a>事务的四大特性:</h2><ul><li>原子性：事务是不可分割的最小操作单元，要么全部成功，要么全部失败</li><li>一致性： 事务完成时必须使所有的数据都保持一致状态</li><li>隔离性： 数据库系统提供的隔离机制，保证事务在不受外部并发影响的独立环境下运行</li><li>持久性：事务一旦提交或回滚，它对数据库中的改变就是永久的</li></ul><h2 id="并发事务问题："><a href="#并发事务问题：" class="headerlink" title="并发事务问题："></a>并发事务问题：</h2><table><thead><tr><th align="center">问题</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">脏读</td><td align="center">一个事务读到另一个事务还没有提交的数据</td></tr><tr><td align="center">不可重复读</td><td align="center">一个事务先后读取同一条记录，但两次读取的数据不同，称之为不可重复读</td></tr><tr><td align="center">幻读</td><td align="center">一个事务按照条件查询数据时，没有对应的数据行，但在插入数据时又发现这行数据已经存在，好像出现了‘‘幻影’’</td></tr></tbody></table><h2 id="事务的隔离级别："><a href="#事务的隔离级别：" class="headerlink" title="事务的隔离级别："></a>事务的隔离级别：</h2><table><thead><tr><th>隔离级别</th><th>脏读</th><th>不可重复读</th><th>幻读</th></tr></thead><tbody><tr><td>read uncommitted</td><td>✔</td><td>✔</td><td>✔</td></tr><tr><td>read committed</td><td>❌</td><td>✔</td><td>✔</td></tr><tr><td>repeatable read(默认)</td><td>❌</td><td>❌</td><td>✔</td></tr><tr><td>serializable</td><td>❌</td><td>❌</td><td>❌</td></tr></tbody></table><p>查看事务的隔离级别</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@transaction_isolation;</span><br></pre></td></tr></table></figure><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20221025173029132.png" alt="image-20221025173029132" style="zoom:67%"><p>设置事务隔离级别</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set session transaction isolation level read uncommitted;</span><br></pre></td></tr></table></figure><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20221025174441090.png" alt="image-20221025174441090" style="zoom:80%"><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221025174723521.png" alt="image-20221025174723521"></p><h1 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h1><blockquote><p>存储引擎就是存储数据建立索引、更新/查询数据等技术的实现方式，存储引擎是基于表的，而不是基于库的，所以存储引擎也可以被成为表类型</p></blockquote><p>mysql默认存储引擎是<font color="red">InnoDB</font>&gt;</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221025175733540.png" alt="image-20221025175733540"></p><ol start="2"><li>查看当前数据库支持的存储引擎</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show engines;</span><br></pre></td></tr></table></figure><ul><li>InnoDB</li></ul><p>介绍InnoDB是一种兼顾高可靠性和高性能的通用存储引擎，在mysql5.5之后，innodb是默认的mysql存储引擎</p><p>特点</p><p>DML操作遵循ACID模型，支持<font color="red">事务</font></p><p>行级锁，提高并发访问性能</p><p>支持外键Foreign key 约束，保证数据的完整性和正确性</p><p>文件</p><p>支持数据库崩溃后自动恢复机制</p><p>xxx.ibd:xxx代表的是表名，innoDB引擎的每张表都会对应一个这样的表空间，存储该表的结构（frm、sdi）、数据和索引。</p><p>参数：innodb_file_per_table</p><p>查看系统变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;innodb_file_per_table&#x27;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">engine=innodb</span><br></pre></td></tr></table></figure><hr><h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><blockquote><p>索引实在数据库表上面的字段添加的，是为了提高查询效率存才的一种机制一张表的一个字段可以添加一个索引，多个字段联合起来也可以添加索引，索引相当于一本书的目录，是为了缩小扫描范围而存在的一种机制</p></blockquote><p>在mysql当中主键上以及unique(唯一)字段上都会自动添加索引！</p><p>什么条件下我们会考虑给字段添加索引？</p><p>条件1：数据量庞大（到底有多么庞大，这个需要测试，因为，每一个硬件环境不同）</p><p>条件2： 该字段经常出现在where后面以条件的形式存在，也就是说这个字段总是被扫描</p><p>条件3： 该字段很少的dml操作（因为dml之后索引需要重新排序）</p><p><font color="red">建议不要随意添加索引，因为索引也是需要维护的，太多的话反而会降低系统的性能。建议通过主键查询，建议通过unique约束字段进行查询，效率是比较高的</font></p><p>索引的优缺点</p><p>创建索引</p><table><thead><tr><th align="center">优势</th><th align="center">劣势</th></tr></thead><tbody><tr><td align="center">提高数据检索的效率，降低数据库的IO成本</td><td align="center">索引也是需要占用空间的</td></tr><tr><td align="center">通过索引列对数据进行排序，降低数据排序的成本，降低cpu的消耗</td><td align="center">索引大大提高了查询效率，同时却降低了更新表的速度，如对表进行insert，updatedelete时，效率降低。</td></tr></tbody></table><p>为什么innodb存储引擎选择使用b+tree索引结构</p><ol><li>相对于二叉树层级更少，搜索效率高</li><li>对于b-tree,无论是叶子节点还是非叶子节点，都会保存数据，这样会导致一页中存储的键值减少，指针随着减少，要同样保存大量的数据只能增加树的高度，导致性能降低。</li><li>相对hash索引，b+tree支持匹配范围及排序操作；</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create index emp_ename index on emp(ename)</span><br><span class="line"></span><br><span class="line"># emp_ename起名</span><br></pre></td></tr></table></figure><p>删除索引</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index emp_ename index on emp;</span><br></pre></td></tr></table></figure><p>查看sql语句是否使用了索引进行检索</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain select *from emp where ename=&#x27;bane&#x27;;</span><br></pre></td></tr></table></figure><h2 id="索引的分类"><a href="#索引的分类" class="headerlink" title="索引的分类"></a>索引的分类</h2><table><thead><tr><th>分类</th><th>含义</th><th>特点</th><th>关键字</th></tr></thead><tbody><tr><td>主键索引</td><td>针对于表中主键创建的索引</td><td>默认自动创建，只能有一个</td><td>primary</td></tr><tr><td>唯一索引</td><td>避免同一个表中某数据列中的值重复</td><td>可以有多个</td><td>unique</td></tr><tr><td>常规索引</td><td>快速定位特定数据</td><td>可以有多个</td><td></td></tr><tr><td>全文索引</td><td>全文索引查找的是文本中的关键词，而不是比较索引中的值</td><td>可以有多个</td><td>fulltext</td></tr></tbody></table><p>在innodb存储引擎中，根据索引的存储形式，又可以分为以下两种。</p><table><thead><tr><th>分类</th><th>含义</th><th>特点</th></tr></thead><tbody><tr><td>聚集索引</td><td>将数据存储与索引放到了一块，索引结构的叶子节点保存了行数据</td><td>必须有，而且只能有一个</td></tr><tr><td>二级索引</td><td>将数据与索引分开存储，索引结构的叶子节点关联的是对应的主键</td><td>可以存在多个</td></tr></tbody></table><p><strong>聚集索引选取规则</strong></p><p><font color="red">注意：</font></p><ol><li>如果存在主键，主键索引就是聚集索引。</li><li>如果不存在主键，将使用第一个唯一索引作为聚集索引</li><li>如果表没有主键，或没有合适的唯一索引，则innodb自动生成一个rowid作为隐藏的聚集索引</li></ol><p><strong>索引的语法</strong></p><ul><li>创建索引</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create [unique|fulltext] index 索引名称 on 表名(字段名...);</span><br><span class="line"></span><br><span class="line"># 一个索引可以包含多个字段，如果一个索引只有一个字段被称为单列索引，多个字段称为联合索引或称为组合索引</span><br></pre></td></tr></table></figure><ul><li>查看索引</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show index from 表名;</span><br></pre></td></tr></table></figure><ul><li>删除索引</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名称 on 表名;</span><br></pre></td></tr></table></figure><h2 id="SQL性能分析"><a href="#SQL性能分析" class="headerlink" title="SQL性能分析"></a>SQL性能分析</h2><blockquote><p>对于我们做sql优化的时候我们经常优化的是select查询语句</p></blockquote><ul><li>SQL执行频率</li></ul><p>mysql连接客户端成功后，通过show [session|global] status 命令提供服务器状态信息，可以查询到insert、update、delete、select的访问频次：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;Com_______&#x27;;			# 共七个下滑线</span><br></pre></td></tr></table></figure><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20221113165044820.png" alt="image-20221113165044820" style="zoom:80%"><ul><li>慢查询日志</li></ul><p>慢查询日志记录了所有执行时间超过指定参数(秒，默认10秒)的所有sql语句</p><p>mysql中的慢查询日志默认没有开启，需要在mysql的配置文件(/etc/my.cnf)中配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 开启mysql满日志查询开关</span><br><span class="line">slow_query_log=on</span><br><span class="line">#设置慢查询日志文件存放路径</span><br><span class="line">slow_query_log_file=/var/log/mariadb/localhost_slow.log</span><br><span class="line"># 设置慢查询日志的时间为1秒，sql语句执行时间超过两秒就会被视为满查询，会被记录到慢查询日志中</span><br><span class="line">long_query_time=1</span><br></pre></td></tr></table></figure><p>在mysql查看mysql慢查询日志是否开启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;slow_query%&#x27;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;long_query%&#x27;;</span><br></pre></td></tr></table></figure><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221113172329297.png" alt="image-20221113172329297"></p><p>查看慢查询日志文件</p><p><code>cat /var/log/mariadb/localhost_slow.log</code></p><p>实时输出慢查询日志文件尾部的信息，可以使用Linux的tail命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f 文件名</span><br></pre></td></tr></table></figure><ul><li>profile详情-<strong>检测每一条查询sql语句的耗时情况</strong></li></ul><p>show profiles能够在做sql优化时帮助我们了解时间都耗费到哪里去了，通过have_profiling参数，能够看到当前mysql是否支持profile操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@profiling; #查看mysql是否支持profile;</span><br></pre></td></tr></table></figure><p>默认profiling是关闭的，可以通过set语句在session/global级别开启prifiling</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set profiling=1;	# 为0是关闭,1为开启</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show profiles;</span><br></pre></td></tr></table></figure><p>查询指定query_id的sql语句各个阶段的耗时情况</p><p>show profile for query id；</p><p>show profile cpu for query id；</p><ul><li>explain执行计划</li></ul><p>explain执行计划各自段含义：</p><ul><li>id</li></ul><p>​ select查询的序列号，表示查询中执行select子句或者是操作表的顺序（id相同，执行顺序从 上到下，id不同，值越大越先执行）</p><ul><li>select_type</li></ul><p>​ 表示select查询类型</p><ul><li>type</li></ul><p>​ 表示连接类型，性能由好到差连接类型为null，const，eq_ref,range,index,all</p><ul><li>possible_key</li></ul><p>​ 显示可能应用在这张表的索引，一个或多个</p><ul><li>key</li></ul><p>​ 实际用到的索引，为null则表示没有用到索引</p><ul><li>key_len</li></ul><p>​ 表示索引中使用的字节数，该值为索引字段最大可能长度，并非实际使用长度，在不损失精确性的前提下，长度越短越好</p><ul><li>filtered</li></ul><p>​ 表示返回结果的行数站需读取行数的百分比，filtered的值越大越好。</p><h2 id="索引使用"><a href="#索引使用" class="headerlink" title="索引使用"></a>索引使用</h2><p>不要在索引列上进行运算，否则索引将会失效，字符串不添加单引号索引也会失效，模糊查询如果只是尾部模糊匹配索引不会失效，如果头部模糊匹配，索引失效。</p><h2 id="索引使用-1"><a href="#索引使用-1" class="headerlink" title="索引使用"></a>索引使用</h2><p>如果索引了多列（联合索引），要遵守最左前缀法则，最左前缀法则指的是查询从索引最左列开始，并且不跳过索引中的列，如果跳跃了某一列，索引将部分失效（后面的索引失效）。</p><p><strong>最左前缀法则，select语句跟你列放的位置没有关系，但是最左边查询的字段必须存在</strong></p><ul><li>范围查询</li></ul><p>联合索引中出现范围查询（&gt;,&lt;）范围查询，右侧的索引列索引失效</p><p>在业务中如果业务允许尽量使用大于等于的运算符保证索引生效</p><ul><li>索引列运算</li></ul><p>不要在索引列上进行运算操作，索引将失效</p><ul><li>字符串不加引号索引失效，因为会出现隐式类型转换</li><li>模糊查询</li></ul><p>如果仅仅是尾部进行模糊匹配，索引不会失效，如果是头部模糊匹配索引失效</p><ul><li>or连接条件</li></ul><p>用or分割开的条件，如果or前的条件中的列有索引，那么涉及的索引都不会被用到。or所连接的字段，任意一侧没有索引那么索引将全部失效</p><ul><li>数据分布影响</li></ul><p>如果mysql评估使用索引比全表还慢，会走全表查询</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221115194415344.png" alt="image-20221115194415344"></p><ul><li>SQL提示</li></ul><p>sql提示是优化数据库的重要手段简单来说就是在sql中添加一些人为的提示来达到优化操作的目的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use index(索引名) #告诉数据库建议用哪个索引</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ignore index(索引名) #告诉数据库不要用哪个索引</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">force index(索引名字)  #必须使用指定索引</span><br></pre></td></tr></table></figure><p>语法格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 三个的语法格式都是</span><br><span class="line">select *from 表名 use index或ignore index或force index  where 条件表达式</span><br><span class="line"># 都是在from表名后添加</span><br></pre></td></tr></table></figure><p>use index是建议mysql使用指定的索引，mysql有权不使用</p><p>force index 必须使用指定索引</p><h1 id="数据的导入导出"><a href="#数据的导入导出" class="headerlink" title="数据的导入导出"></a>数据的导入导出</h1><h2 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h2><p><strong>检索目录</strong></p><blockquote><p>MySQL要求数据导入导出调用的文件在MySQL的检索目录下才可以</p></blockquote><p>安装mysql服务软件时，会自动创建检索目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;secure file priv&quot;; # 查看</span><br></pre></td></tr></table></figure><p>把系统文件的内容存储到数据库的表里。默认只有root用户拥有数据导入权限</p><p>数据导入步骤</p><ul><li>建表</li><li>拷贝文件到检索目录下</li><li>导入数据</li></ul><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/image-20230410203030833.png" alt="image-20230410203030833" style="zoom:50%"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">load data infile &quot;/目录名/文件名&quot;</span><br><span class="line">into table 库名.表名</span><br><span class="line">fields terminated by &quot;符号&quot; # 列间隔符号</span><br><span class="line">lines terminated by &quot;\n&quot;; # 行结束符号 \n换行</span><br></pre></td></tr></table></figure><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230410203828920.png" alt="image-20230410203828920"></p><h2 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h2><p>一共有三种命令格式分别是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">格式1：</span><br><span class="line">select into outfile &quot;/目录名/文件名&quot;;</span><br><span class="line"></span><br><span class="line">格式2：</span><br><span class="line">select into outfile &quot;/目录名/文件名&quot;</span><br><span class="line">terminated by &quot;分隔符&quot;;</span><br><span class="line"># 默认会以换行符号\n当做每一行的结束符</span><br><span class="line"></span><br><span class="line">格式3：</span><br><span class="line">select into outfile &quot;/目录名/文件名&quot;;</span><br><span class="line">terminated by &quot;分隔符号&quot;; # 如 ：</span><br><span class="line">lines terminated &quot;结束符号&quot;;# 想使用其他符号当做每一行的结束符号 如 ###</span><br></pre></td></tr></table></figure><p><strong>第一种格式演示图</strong></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230410204556832.png" alt="image-20230410204556832"></p><p><strong>第二种格式演示图</strong></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230410204627190.png" alt="image-20230410204627190"></p><p><strong>第三种格式演示图</strong></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230410204924286.png" alt="image-20230410204924286"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总结如下：</p><ul><li>导出数据的行数有SQL查询决定</li><li>导出的是表的记录，不包括字段名</li><li>自动创建存储数据的文件</li><li>存储数据文件，具有唯一性</li></ul><h1 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -h服务器 -u 用户名 -p 密码 数据库名 &gt;备份文件.sql</span><br><span class="line"></span><br><span class="line"># 选项</span><br><span class="line">-A 备份所有的库</span><br><span class="line">-B 备份多个数据库</span><br><span class="line">-F 备份之前刷新日志</span><br><span class="line">-E 备份时间调度器的代码</span><br><span class="line">-R 备份存储过程和存储函数</span><br></pre></td></tr></table></figure><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221109170916972.png" alt="image-20221109170916972"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221109171014484.png" alt="image-20221109171014484"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221109171845675.png" alt="image-20221109171845675"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221109173626513.png" alt="image-20221109173626513"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221109173947319.png" alt="image-20221109173947319"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221109175625635.png" alt="image-20221109175625635"></p><h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><blockquote><p>视图就是一个虚拟的表，没有真实数据，他是由select查询语句定义，同真实的表数据一致，但是视图并不在数据库中以存储的数据形式存在</p></blockquote><p>视图的作用：</p><ol><li>安全原因，视图可以隐藏一些敏感的信息</li><li>简化查询，对查询语句简化</li></ol><p><strong>语法格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create  [or replace ] view 定义的视图名 AS select查询语句;</span><br><span class="line"># or replace 是可以创建并且也可以对视图进行修改</span><br></pre></td></tr></table></figure><p>例如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create view myuser as select user,host from mysql.user;</span><br><span class="line"></span><br><span class="line">select *from my.user;</span><br><span class="line"># 简化查询步骤</span><br></pre></td></tr></table></figure><p><strong>查询视图</strong></p><p>查看创建视图的语句</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create view 视图名称;</span><br></pre></td></tr></table></figure><p>查看视图数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from 视图名称;</span><br></pre></td></tr></table></figure><p><strong>修改视图</strong></p><p>第一种：直接使用创建视图的语句添加select查询的字段前提需要添加or replace</p><p>创建视图是如果存在已同名的视图则重新创建</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create or replace view 原视图名称 as 新的查询语句;</span><br></pre></td></tr></table></figure><p>第二种：使用alter语句修改视图</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter view 视图名称 as 新的查询语句;</span><br></pre></td></tr></table></figure><p><strong>删除视图</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop view 视图名称;</span><br></pre></td></tr></table></figure><p>视图的检查选项</p><p>当使用with check option子句创建视图时，mysql会通过视图检查正在更改的每一个行，例如插入，更新，，删除，以使其符合视图的定义，mysql允许基于另一个视图创建视图，它还会检查依赖视图中的规则以保持一致为了确定检查的范围，mysql提供了两个选项cascaded和local默认是cascaded</p><p>cascaded和之前创建外键实现级联删除和级联更新的cascade一样</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add constraint 约束名 foreign key (字段名) references 被参照的表 (被参照的表的字段) on update cascade 级联更新|on delete cascade 级联删除;</span><br></pre></td></tr></table></figure><p>local会递归去找当前视图所依赖的视图的检查选项</p><p><strong>视图更新</strong></p><p>要使视图可更新，视图中的行与基础视图中的行之间必须要存在一对一的关系，如果视图包含以下任何一项则该视图不可更新</p><ol><li>聚合函数或窗口函数（sum，min，max，avg，count等）</li><li>distinct 去重</li><li>group by</li><li>having</li><li>union或union all</li></ol><h1 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h1><blockquote><p>存储过程是事先经过编译并存储在数据库中的一段sql语句的集合，调用存储过程可以简化应用开发人员的很多工作，减少数据在数据库和应用服务器之间的传输，对于提高数据处理的效率是有好处的。</p><p>存储过程思想上很简单，就是数据库sql语言里面的代码封装与重用。</p></blockquote><ul><li>特点</li></ul><p>封装，复用</p><p>可以接收参数，也可以返回数据</p><p>减少网络交互，效率提升</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a><strong>语法</strong></h3><ul><li>创建</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create procedure 存储过程名称（【参数列表】）</span><br><span class="line">begin</span><br><span class="line">	sql语句</span><br><span class="line">end；</span><br></pre></td></tr></table></figure><ul><li>调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call 名称 （【参数】）</span><br></pre></td></tr></table></figure><ul><li>查看</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create procedure 存储过程名称；</span><br></pre></td></tr></table></figure><ul><li>删除</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop procedure if exists 存储过程名；</span><br></pre></td></tr></table></figure><p><font size="3px" color="red">注意：在命令行中，执行创建存储过程的sql时，需要通过关键字delimiter指定sql语句的结束符。</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delimiter $$</span><br></pre></td></tr></table></figure><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a><strong>变量</strong></h3><blockquote><p>系统变量是mysql服务器提供，不是用户定义的，属于服务器层面，分为全局变量（global），会话变量（session）</p></blockquote><p>系统变量</p><p>查看系统变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show global|session variables; # 后面可以加上like模糊匹配</span><br><span class="line">select @@session|global 系统变量名；# 查看指定变量值</span><br></pre></td></tr></table></figure><p>默认不写全局或会话变量，默认就是会话变量</p><p><font size="3px" color="red">注意两个@表示的是系统变量一个@表示用户自定义变量</font></p><h3 id="用户自定义变量"><a href="#用户自定义变量" class="headerlink" title="用户自定义变量"></a><strong>用户自定义变量</strong></h3><blockquote><p>用户根据自己定义的变量，用户变量不用提前声明，在用的时候直接用@变量名使用就可以，其作用域为当前连接。</p></blockquote><p>赋值</p><p><code>set @变量名=值；</code></p><p><code>set @变量名:=值;</code></p><p><code>select @变量名:=值;</code></p><p><code>select 字段名 into @变量名 from 表名; #将表查询的结果赋值给一个变量</code></p><p>推荐使用:=来给定义变量</p><p>使用</p><p><code>select @变量名;</code></p><p>用户自定义的变量无需赋值，默认是个空值null</p><h3 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a><strong>局部变量</strong></h3><p>局部变量是根据需要定义的在局部生效的变量，访问之前需要declare声明，可用作存储过内的局部变量和输入参数，局部变量的范围是在其内声明的begin…end块。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 声明</span><br><span class="line">declare 变量名 变量类型 [default...]</span><br></pre></td></tr></table></figure><p>变量类型就是数据的字段类型，int，varchar，char，date。enum，time等</p><p>赋值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set 变量名=值;</span><br><span class="line">set 变量名:=值;</span><br><span class="line">select 字段名 into 变量名 from 表名;</span><br></pre></td></tr></table></figure><h3 id="条件判断if"><a href="#条件判断if" class="headerlink" title="条件判断if"></a><strong>条件判断if</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if 条件1 then</span><br><span class="line">	sql语句;</span><br><span class="line">elseif 条件2 then</span><br><span class="line">	sql语句;</span><br><span class="line">else</span><br><span class="line">	不满足条件1和条件2执行;</span><br><span class="line">end if;</span><br></pre></td></tr></table></figure><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a><strong>参数</strong></h3><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221208152158056.png" alt="image-20221208152158056"></p><h3 id="条件判断case"><a href="#条件判断case" class="headerlink" title="条件判断case"></a><strong>条件判断case</strong></h3><ul><li>语法格式1</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">case 表达式</span><br><span class="line">	when 1 then sql语句;</span><br><span class="line">	when 2 then sql语句;</span><br><span class="line">	else sql语句;</span><br><span class="line">end case;</span><br><span class="line"></span><br><span class="line"># 如果说表达式的值为1的话执行when 1 then后面的语句，为2同理</span><br></pre></td></tr></table></figure><ul><li>语法格式2</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">case</span><br><span class="line">	when a=1 then sql语句;</span><br><span class="line">	when a=2 then sql语句;</span><br><span class="line">	else sql语句;</span><br><span class="line">end case;</span><br></pre></td></tr></table></figure><h3 id="循环while"><a href="#循环while" class="headerlink" title="循环while"></a><strong>循环while</strong></h3><ul><li>先判定条件如果条件为true则执行逻辑，否则，不执行逻辑</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while 条件 do</span><br><span class="line">	sql语句;</span><br><span class="line">end while;</span><br></pre></td></tr></table></figure><h3 id="循环repeat"><a href="#循环repeat" class="headerlink" title="循环repeat"></a><strong>循环repeat</strong></h3><ul><li>repeat是有条件的循环控制语句，当满足条件的时候退出循环，具体语法为：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 先执行一次逻辑然后判定逻辑是否满足，如果满足则退出如果不满足则继续下一次循环</span><br><span class="line">repeat</span><br><span class="line">	sql语句;</span><br><span class="line">	until 条件</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure><h3 id="循环loop"><a href="#循环loop" class="headerlink" title="循环loop"></a><strong>循环loop</strong></h3><ul><li>lopp实现简单的循环，如果不在sql逻辑中增加退出循环的条件，可以用来实现简单的死循环，loop可以配合一下两个语句使用;</li><li>leave ：配合循环使用，退出循环</li><li>iterate ： 必须用在循环中，作用是跳过当前循环剩下的语句，直接进入下一次循环。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[标记;] loop</span><br><span class="line">	sql逻辑</span><br><span class="line">end loop [标记;]</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">leave label; 指定标记的循环体</span><br><span class="line">iterate label; 直接进入下一次循环</span><br></pre></td></tr></table></figure><h3 id="游标"><a href="#游标" class="headerlink" title="游标"></a><strong>游标</strong></h3><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221208162108850.png" alt="image-20221208162108850"></p><h3 id="条件处理程序"><a href="#条件处理程序" class="headerlink" title="条件处理程序"></a>条件处理程序</h3><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221208162034619.png" alt="image-20221208162034619"></p><h3 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h3><ul><li>存储函数是有返回值的存储过程，存储函数的参数只能是in（输入类型）具体语法如下：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create function 存储函数名称(参数列表)</span><br><span class="line">returns type [characteristic...]</span><br><span class="line">begin</span><br><span class="line">	sql语句;</span><br><span class="line">	return...;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line">characteristic说明</span><br><span class="line">- deterministic: 相同的输入参数总是产生相同的结果</span><br><span class="line">- no sql：不包含sql语句</span><br><span class="line">- reads sql data 包含读取数据的语句，但不包含写入数据的语句。</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h1><ul><li>触发器是与表相关的数据对象，是指在insert/update/delete之前或者是之后，触发并执行触发器中定义的sql语句集合。触发器的这种特性可以协助应用在数据库端确保数据的完整性，日志记录，数据校验等操作。</li><li>使用别名old和new来引用触发器中发生变化的记录内容，这与其他的数据库是相似的，现在触发器还只支持行级触发，不支持语句级别触发。</li></ul><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20221208164107653.png" alt="image-20221208164107653"></p><ul><li>语法</li></ul><p><strong>创建</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create trigger 触发器名称</span><br><span class="line">before/after insert/update/delete on 表名 for each row</span><br><span class="line">begin</span><br><span class="line">	sql语句;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure><p><strong>查看</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show triggers;</span><br></pre></td></tr></table></figure><p><strong>删除</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop trigger [数据库.]触发器名字 # 如果不指定数据库名字则表示当前数据库</span><br></pre></td></tr></table></figure><h1 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h1><ul><li>介绍</li></ul><p>锁是计算机协调多个进程或线程并发访问某一资源的机制。在数据库中除传统的计算资源的争用外，数据也是一种供许多用户共享的资源，如何保证数据并发访问的一致性，有效性是所有数据库必须解决的一个问题，锁冲突也是影响数据并发访问性能的一个重要因素，从这个角度来说，锁对数据库而显得尤其重要，也更加复杂。</p><p>按照锁的粒度分，分为三类，全局锁（锁定数据库中的所有表），表级锁（每次操作锁住整张表），行级锁（每次操作锁住对应的行数据）。</p><h2 id="全局锁"><a href="#全局锁" class="headerlink" title="全局锁"></a>全局锁</h2><ul><li>介绍</li></ul><p>全局锁就是对整个数据库实例加锁，加锁后整个实例就处于只读状态，后续的dml的写语句，ddl语句，已经更新操作的事物提交语句都将被阻塞。</p><p>通常的使用场景事做全库的逻辑备份，对所有的表进行锁定，从而获取一致性视图，保证数据的完整性。</p><p><strong>加锁</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flush tables  with read lock;</span><br></pre></td></tr></table></figure><p><strong>解锁</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unlock tables;</span><br></pre></td></tr></table></figure><p><font color="red">在innodb引擎中，我们可以在备份时加上参数–single-transaction参数来完成不加锁的一致性数据备份</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump --single-transaction  -u root -p123456 数据库名&gt;自定义命名.sql</span><br></pre></td></tr></table></figure><h2 id="表级锁"><a href="#表级锁" class="headerlink" title="表级锁"></a>表级锁</h2><ul><li>介绍</li></ul><p>表级锁，每次操作锁住整张表，锁定粒度大，发生锁冲突的概率最高，并发度最低，应用在myisam，innodb，bdb等存储引擎中。</p><p>对于表级锁主要分为以下三类：</p><ol><li><p>表锁</p></li><li><p>元数据锁（meta data lock，mdl）</p></li><li><p>意向锁</p></li></ol><h3 id="表锁"><a href="#表锁" class="headerlink" title="表锁"></a>表锁</h3><ul><li>表锁分为两类：</li></ul><ol><li>表共享读锁（read lock）</li><li>表独占写锁（write lock）</li></ol><p>语法：</p><ol><li><p>加锁：<code>lock tables 表名... read/write</code>。</p></li><li><p>释放锁：<code>unlock tables</code>/客户端断开连接。</p></li></ol><p>加了写锁后当前客户端可以读取和写入这个表，其他客户端不能读取和写入。会处于阻塞状态</p><h3 id="元数据锁"><a href="#元数据锁" class="headerlink" title="元数据锁"></a>元数据锁</h3><p>mdl加锁过程是系统自动控制，无需显式使用，在访问一张表的时候会自动加上。mdl锁主要作用事维护表元数据的一致性，在表上有活动事务的时候，不可以对元数据进行写入操作。<font color="red">为了避免DML与DDL冲突，保证读写的正确性。</font></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223101946934.png" alt="image-20230223101946934"></p><p>查看元数据锁</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223102133665.png" alt="image-20230223102133665"></p><h3 id="意向锁"><a href="#意向锁" class="headerlink" title="意向锁"></a>意向锁</h3><p>为了避免DML语句在执行时，加的行锁，与表锁的冲突，在innodb中引入了意向锁，使得表锁不用检查每行数据是否加锁，使用意向锁来减少表锁的检查。</p><ol><li>意向共享锁（IS）：与表锁共享锁(read)兼容，与表锁</li></ol><p>排它锁(write)互斥。</p><ol start="2"><li>意向排他锁(IX)：与表共享锁(read)及排它锁(write)都互斥，意向锁之间不会互斥</li></ol><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223103410094.png" alt="image-20230223103410094"></p><h2 id="行级锁"><a href="#行级锁" class="headerlink" title="行级锁"></a>行级锁</h2><p>行级锁，每次操作锁住对应的行数据。锁定粒度小，发生锁冲突的概率最低，并发度最高，应用在innodb存储引擎中。</p><p>innodb的数据是基于索引组织的，行锁是通过对索引上的索引项加锁来实现的，而不是对记录加的锁，对于行级锁，主要分为以下三类。</p><p>行锁(record lock): 锁定单个行记录的锁，防止其他事物对此进行update，delete。在rc，rr隔离级别下都支持。</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223104433763.png" alt="image-20230223104433763"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223104508927.png" alt="image-20230223104508927"></p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223104606784.png" alt="image-20230223104606784"></p><p>间隙锁（GAP lock）：锁定索引记录间隙(不含该记录)，保证索引记录的间隙不变，并锁住数据前面的间隙gap，在rr隔离级别下支持。</p><p>临键锁(Next-key lock):行锁和间隙锁组合，同时锁住数据，并锁住数据前面的间隙gap，在rr隔离级别下支持。</p><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230223104657793.png" alt="image-20230223104657793"></p><h1 id="运维篇"><a href="#运维篇" class="headerlink" title="运维篇"></a>运维篇</h1><p>日志</p><ul><li>错误日志</li><li>二进制日志</li><li>查询日志</li><li>慢查询日志</li></ul><h2 id="错误日志"><a href="#错误日志" class="headerlink" title="错误日志"></a>错误日志</h2><p>错误日志是mysql中最重要的日志之一，它记录了mysqld启动和停止时，以及服务器在运行过程中发生任何严重错误时的相关信息。当数据库出现任何故障导致无法正常使用时，建议首先查看此日志。</p><p>该日志是默认开启的，默认存放目录/var/log/，默认的日志文件名为mysqld.log。查看日志位置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;%log_error%&quot;</span><br></pre></td></tr></table></figure><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230316103330611.png" alt="image-20230316103330611"></p><h2 id="二进制日志"><a href="#二进制日志" class="headerlink" title="二进制日志"></a>二进制日志</h2><p>二进制日志，记录了所有的DDL（数据定义语言）语句和DML（数据操纵语言）语句，但不包括数据查询（select，show）语句。</p><p>作用:灾难时的数据恢复。mysql的主从复制。在mysql8版本中默认的二进制日志是开启着的，涉及到的参数如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;%log_bin%&quot;</span><br></pre></td></tr></table></figure><p><img src="https://jihulab.com/yuntian/img/-/raw/main/mysql%E7%AC%94%E8%AE%B0/image-20230316103854034.png" alt="image-20230316103854034"></p><h2 id="查询日志"><a href="#查询日志" class="headerlink" title="查询日志"></a>查询日志</h2><p>查询日志中记录了客户端的所有操作语句，而二进制日志不包含查询数据的SQL语句，默认情况下摩擦互相你日志是未开启的。如果需要开启查询日志，可以设置以下配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;%general%&quot;</span><br></pre></td></tr></table></figure><p>修改MySQL的配置文件/etc/my.cnf文件，添加如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 该选项用来开启慢查询日志，可选值0H或1 0关闭 1开启</span><br><span class="line">general_log=1</span><br><span class="line">#设置日志的文件名，如果没有指定默认为host_name.log</span><br><span class="line">general_log_file=mysql.query.log</span><br></pre></td></tr></table></figure><h2 id="慢查询日志"><a href="#慢查询日志" class="headerlink" title="慢查询日志"></a>慢查询日志</h2><p>慢查询日子记录了所有执行时间超过参数long_query_time设置值并且扫描记录数不小于min_examined_row_limit的所有的SQL语句的日志，默认未开启。long_query_time默认为10秒，最小为0，精度可以到微秒。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#慢查询日志</span><br><span class="line">slow_query_log=1</span><br><span class="line">#执行时间参数</span><br><span class="line">long_query_time=2</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://yyt.gs">久绊</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://yyt.gs/mysql/">https://yyt.gs/mysql/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yyt.gs" target="_blank">Yyt Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://jihulab.com/yuntian/img/-/raw/main/mysql笔记/head.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://npm.elemecdn.com/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://npm.elemecdn.com/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/jujingyi/" title="随机鞠婧祎壁纸"><img class="cover" src="https://jihulab.com/yuntian/img/-/raw/main/head/ppdHAWd.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">随机鞠婧祎壁纸</div></div></a></div><div class="next-post pull-right"><a href="/docker/" title="Docker学习笔记"><img class="cover" src="https://jihulab.com/yuntian/img/-/raw/main/head/docker-logo.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Docker学习笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/gxxj/" title="高校学籍管理系统"><img class="cover" src="https://pic3.zhimg.com/v2-58d652598269710fa67ec8d1c88d8f03_r.jpg?source=1940ef5c" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-18</div><div class="title">高校学籍管理系统</div></div></a></div><div><a href="/mysqlzc/" title="MySQL主从复制"><img class="cover" src="https://www.toopic.cn/public/uploads/small/1634202081493163420208139.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-27</div><div class="title">MySQL主从复制</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://q2.qlogo.cn/g?b=qq&amp;nk=2913319095&amp;s=100" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">久绊</div><div class="author-info__description">手执烟火以谋生 心怀诗意以谋爱</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yyt-j"><i class="fab fa-github"></i><span>Github 主页</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://i.gsbok.cn" target="_blank" title="个人主页"><i class="iconfont icon-wode1"></i></a><a class="social-icon" href="https://github.com/yyt-j" target="_blank" title="Github"><i class="iconfont icon-github"></i></a><a class="social-icon" href="mailto:gsbok7@gmail.com" target="_blank" title="Email"><i class="iconfont icon-youxiang"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来访！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">MySQL笔记</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99"><span class="toc-number">2.</span> <span class="toc-text">SQL命令的使用规则</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">连接方式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.</span> <span class="toc-text">数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.1.</span> <span class="toc-text">字符类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.</span> <span class="toc-text">数值类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.3.</span> <span class="toc-text">日期时间类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%85%B3%E9%94%AE%E5%AD%97%E6%B3%A8%E6%84%8F"><span class="toc-number">4.4.</span> <span class="toc-text">类型关键字注意</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.5.</span> <span class="toc-text">枚举类型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">数据库基本管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DDL-%E5%BA%93%E7%AE%A1%E7%90%86%E6%93%8D%E4%BD%9C"><span class="toc-number">5.1.</span> <span class="toc-text">DDL-库管理操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DDL-%E8%A1%A8%E7%BB%93%E6%9E%84%E4%BF%AE%E6%94%B9"><span class="toc-number">5.2.</span> <span class="toc-text">DDL-表结构修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DML-%E6%B7%BB%E5%8A%A0%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">5.3.</span> <span class="toc-text">DML-添加表数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DML-%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">5.4.</span> <span class="toc-text">DML-修改表数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DML-%E5%88%A0%E9%99%A4%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">5.5.</span> <span class="toc-text">DML-删除表数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL-%E5%B8%B8%E7%94%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.6.</span> <span class="toc-text">DQL-常用查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.7.</span> <span class="toc-text">DQL-条件查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.8.</span> <span class="toc-text">DQL-聚合函数查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.9.</span> <span class="toc-text">DQL-分组查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL-%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.10.</span> <span class="toc-text">DQL-排序查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DQL-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.11.</span> <span class="toc-text">DQL-分页查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DCL-%E6%95%B0%E6%8D%AE%E6%8E%A7%E5%88%B6%E8%AF%AD%E8%A8%80"><span class="toc-number">5.12.</span> <span class="toc-text">DCL-数据控制语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DCL-%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7"><span class="toc-number">5.13.</span> <span class="toc-text">DCL-管理用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DCL-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">5.14.</span> <span class="toc-text">DCL-权限控制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">6.1.</span> <span class="toc-text">字符串函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">6.2.</span> <span class="toc-text">时间函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.</span> <span class="toc-text">约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E6%BC%94%E7%A4%BA"><span class="toc-number">7.1.</span> <span class="toc-text">约束演示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.</span> <span class="toc-text">主键约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.3.</span> <span class="toc-text">外键约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.4.</span> <span class="toc-text">唯一约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.5.</span> <span class="toc-text">非空约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.6.</span> <span class="toc-text">检查约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.7.</span> <span class="toc-text">默认约束</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.</span> <span class="toc-text">多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E5%85%B3%E7%B3%BB"><span class="toc-number">8.1.</span> <span class="toc-text">多表关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E6%A6%82%E8%BF%B0"><span class="toc-number">8.2.</span> <span class="toc-text">多表查询概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2-%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-number">8.3.</span> <span class="toc-text">连接查询-内连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.4.</span> <span class="toc-text">外连接查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5%E8%AF%AD%E6%B3%95%EF%BC%9A"><span class="toc-number">8.5.</span> <span class="toc-text">自连接语法：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.6.</span> <span class="toc-text">联合查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.7.</span> <span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9Cunion"><span class="toc-number">8.8.</span> <span class="toc-text">合并查询结果union</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">9.</span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7"><span class="toc-number">9.1.</span> <span class="toc-text">事务的四大特性:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">9.2.</span> <span class="toc-text">并发事务问题：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%EF%BC%9A"><span class="toc-number">9.3.</span> <span class="toc-text">事务的隔离级别：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">10.</span> <span class="toc-text">存储引擎</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">11.</span> <span class="toc-text">索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">11.1.</span> <span class="toc-text">索引的分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">11.2.</span> <span class="toc-text">SQL性能分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8"><span class="toc-number">11.3.</span> <span class="toc-text">索引使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8-1"><span class="toc-number">11.4.</span> <span class="toc-text">索引使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA"><span class="toc-number">12.</span> <span class="toc-text">数据的导入导出</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5"><span class="toc-number">12.1.</span> <span class="toc-text">导入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA"><span class="toc-number">12.2.</span> <span class="toc-text">导出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">12.3.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD"><span class="toc-number">13.</span> <span class="toc-text">备份</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">14.</span> <span class="toc-text">视图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">15.</span> <span class="toc-text">存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">15.0.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">15.0.2.</span> <span class="toc-text">变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">15.0.3.</span> <span class="toc-text">用户自定义变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">15.0.4.</span> <span class="toc-text">局部变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%ADif"><span class="toc-number">15.0.5.</span> <span class="toc-text">条件判断if</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0"><span class="toc-number">15.0.6.</span> <span class="toc-text">参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%ADcase"><span class="toc-number">15.0.7.</span> <span class="toc-text">条件判断case</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AFwhile"><span class="toc-number">15.0.8.</span> <span class="toc-text">循环while</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AFrepeat"><span class="toc-number">15.0.9.</span> <span class="toc-text">循环repeat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AFloop"><span class="toc-number">15.0.10.</span> <span class="toc-text">循环loop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-number">15.0.11.</span> <span class="toc-text">游标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="toc-number">15.0.12.</span> <span class="toc-text">条件处理程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">15.0.13.</span> <span class="toc-text">存储函数</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">16.</span> <span class="toc-text">触发器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%94%81"><span class="toc-number">17.</span> <span class="toc-text">锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%94%81"><span class="toc-number">17.1.</span> <span class="toc-text">全局锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E7%BA%A7%E9%94%81"><span class="toc-number">17.2.</span> <span class="toc-text">表级锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E9%94%81"><span class="toc-number">17.2.1.</span> <span class="toc-text">表锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE%E9%94%81"><span class="toc-number">17.2.2.</span> <span class="toc-text">元数据锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%90%91%E9%94%81"><span class="toc-number">17.2.3.</span> <span class="toc-text">意向锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%8C%E7%BA%A7%E9%94%81"><span class="toc-number">17.3.</span> <span class="toc-text">行级锁</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%90%E7%BB%B4%E7%AF%87"><span class="toc-number">18.</span> <span class="toc-text">运维篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-number">18.1.</span> <span class="toc-text">错误日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97"><span class="toc-number">18.2.</span> <span class="toc-text">二进制日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">18.3.</span> <span class="toc-text">查询日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">18.4.</span> <span class="toc-text">慢查询日志</span></a></li></ol></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/network/" title="网络基础笔记"><img src="https://jihulab.com/yuntian/img/-/raw/main/网络基础笔记.img/QQ图片20230518114952.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="网络基础笔记"></a><div class="content"><a class="title" href="/network/" title="网络基础笔记">网络基础笔记</a><time datetime="2023-05-16T10:50:00.000Z" title="发表于 2023-05-16 18:50:00">2023-05-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/computer-rethink/" title="一次手贱造成的事故反思"><img src="https://jihulab.com/yuntian/img/-/raw/main/%E5%8F%8D%E6%80%9D/img2_logo.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="一次手贱造成的事故反思"></a><div class="content"><a class="title" href="/computer-rethink/" title="一次手贱造成的事故反思">一次手贱造成的事故反思</a><time datetime="2023-04-22T10:58:00.000Z" title="发表于 2023-04-22 18:58:00">2023-04-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/butterfly1/" title="Butterfly主题双栏布局卡片高度不一致解决方法"><img src="https://www.toopic.cn/public/uploads/small/1642751430710164275143071.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Butterfly主题双栏布局卡片高度不一致解决方法"></a><div class="content"><a class="title" href="/butterfly1/" title="Butterfly主题双栏布局卡片高度不一致解决方法">Butterfly主题双栏布局卡片高度不一致解决方法</a><time datetime="2023-04-20T10:50:00.000Z" title="发表于 2023-04-20 18:50:00">2023-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/nginx/" title="Nginx学习笔记"><img src="https://www.toopic.cn/public/uploads/small/1642752073265164275207379.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Nginx学习笔记"></a><div class="content"><a class="title" href="/nginx/" title="Nginx学习笔记">Nginx学习笔记</a><time datetime="2023-04-19T10:50:00.000Z" title="发表于 2023-04-19 18:50:00">2023-04-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/openstack/" title="OpenStack学习笔记"><img src="https://jihulab.com/yuntian/img/-/raw/main/head/openstack_logo.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="OpenStack学习笔记"></a><div class="content"><a class="title" href="/openstack/" title="OpenStack学习笔记">OpenStack学习笔记</a><time datetime="2023-04-17T02:00:00.000Z" title="发表于 2023-04-17 10:00:00">2023-04-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="footer_custom_text"><div id="footer-wrap"><div id="footer_deal"><a class="social-icon" href="mailto:2913319095@qq.com" target="_blank" title="Email" rel="external nofollow noopener noreferrer"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://github.com/yyt-j" target="_blank" title="Github" rel="external nofollow noopener noreferrer"><i class="fab fa-github"></i></a><a class="social-icon" href="/" target="_blank" title="Bilibili" rel="external nofollow noopener noreferrer"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=1340610221" target="_blank" title="网易云" rel="external nofollow noopener noreferrer"><i class="fa-solid fa-compact-disc"></i></a></div><div id="mj-footer"><div class="footer-group"><h3 class="footer-title">推荐<i class="fa fa-fire" style="color:var(--mj-red);padding-left:5px"></i></h3><div class="footer-links"><a class="footer-item" href="/archives/">全部文章</a><a class="footer-item" href="/tags/">全部标签</a><a class="footer-item" href="/categories/">全部分类</a></div></div><div class="footer-group"><h3 class="footer-title">生活</h3><div class="footer-links"><a class="footer-item" href="/Gallery/photo/">我的相册</a><a class="footer-item" target="_blank" rel="noopener" href="https://i.y.qq.com/n2/m/share/details/taoge.html?platform=11&appshare=android_qq&appversion=12000508&hosteuin=owE5oio5NKnq7v**&id=7008065173&ADTAG=qfshare">我的歌单</a><a class="footer-item" href="/time/">日常哔哔</a></div></div><div class="footer-group"><h3 class="footer-title">网站</h3><div class="footer-links"><a class="footer-item" href="/message/">留言信箱</a><a class="footer-item" href="/about/">关于博客</a><a class="footer-item" target="_blank" rel="noopener" href="https://status.yyt.gs/">状态监控</a></div></div><div class="footer-group"><h3 class="footer-title">导航</h3><div class="footer-links"><a class="footer-item" target="_blank" rel="external nofollow noopener noreferrer" href="https://yyt.gs/">博客首页</a><a class="footer-item" href="/link/">友情链接</a><a class="footer-item" href="/copy/">我的文案</a></div></div><div class="footer-group"><h3 class="footer-title">服务</h3><div class="footer-links"><a class="footer-item" href="mailto:2913319095@qq.com">联系方式</a><a class="footer-item" target="_blank" rel="noopener" href="https://foreverblog.cn/go.html">空间虫洞</a><a class="footer-item" target="_blank" rel="noopener" href="https://github.com/yyt-j">GitHub</a></div></div></div><a href="https://icp.gov.moe/?keyword=20235213" target="_blank"><img src="https://jihulab.com/jiuban1/img/-/raw/main/%E8%90%8C%E5%A4%87icon/ico64.png" width="15" height="15">萌ICP备20235213号</a></div><div class="copyright">&copy;2020 - 2023 By 久绊</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://pl.yyt.gs/",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null))},o=()=>{"object"!=typeof twikoo?getScript("https://npm.elemecdn.com/twikoo@1.6.8/dist/twikoo.all.min.js").then(t):setTimeout(t,0)};btf.loadComment(document.getElementById("twikoo-wrap"),o)})()</script></div><script src="/js/global.js"></script><script src="https://npm.elemecdn.com/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>